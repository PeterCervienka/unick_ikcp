<!doctype html>
<html lang="us">
<head>
    <meta charset="utf-8">
    <title>Individuálne komplexné cestovné poistenie</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="css/_app.css" rel="stylesheet">
    <script src="js/baseliner.js"></script>
    <script>
        window.onload = function() {
            baseliner = new Baseliner({'gridColor': [255,0,0], 'gridOpacity': 10, 'gridHeight': 12});
        };
    </script>
</head>
<body>
<div class="un-v1 single header">
    <img src="assets/logo-union.svg" border="0" width="146" height="48">
    <h1>Individuálne komplexné cestovné poistenie</h1>
</div>
<div class="un-v1 single">
<div class="separator error">
    <h2>Chyba</h2>
    <div>Skontrolujte všetky polia označené červenou farbou.</div>
</div>
<div class="row-4">
    <div class="single required calendar">
        <label>Poistený od</label>
        <input data-bind="value: insuredFrom, jq: 'birthDatePicker'" type="text" name="from" value="">
    </div>
    <div class="single required calendar has-error">
        <label>Do</label>
        <input data-bind="value: insuredTo, jq: 'birthDatePicker'" type="text" name="to" value="" placeholder=" ">
        <div class="error">Doplňte dátum</div>
    </div>
</div>
<table class="edit-grid">
<thead>
<tr>
    <th class="right">Rovnaké pre všetkých</th>
    <th><span class="glyphicon glyphicon-arrow-down"></span></th>
    <!-- ko foreach: insuredPersons -->
    <th><a data-bind="click: $root.removePerson, visible: $root.showRemovePerson" href="#remove" title="odobrať">Del</a></th>
    <!-- /ko -->
    <th><a data-bind="click: addPerson, visible: showAddPerson" href="#add" title="pridat">Add</a></th>
</tr>
</thead>
<tfoot>
<tr>
    <td>Za osobu:</td>
    <td></td>
    <!-- ko foreach: insuredPersons -->
    <td data-bind="html: $data.summary"></td>
    <!-- /ko -->
    <td></td>
</tr>
<tr>
    <td><strong>Cena spolu:</strong></td>
    <td></td>
    <td colspan="9">
        <strong>1200 €</strong>
        <div class="alert">
            Využite rodinnú zľavu: ušetríte <strong>3,50 €</strong>. <a href="#set_discount" class="button small inline">Uplatniť zľavu</a>
        </div>
    </td>
</tr>
</tfoot>
<tbody>
<tr class="section">
    <td>Osoba</td>
    <td></td>
    <!-- ko foreach: insuredPersons -->
    <td></td>
    <!-- /ko -->
    <td></td>
</tr>
<tr class="has-fields">
    <td>Meno</td>
    <td></td>
    <!-- ko foreach: insuredPersons -->
    <td><input data-bind="value: $data.name, attr: {tabindex:$index()*15+1, id:'name'+$index()}" type="text"/></td>
    <!-- /ko -->
    <td></td>
</tr>
<tr class="has-fields">
    <td>Priezvisko</td>
    <td></td>
    <!-- ko foreach: insuredPersons -->
    <td><input data-bind="value: $data.surname, attr: {tabindex:$index()*15+2, id:'surname'+$index()}" type="text"/></td>
    <!-- /ko -->
    <td></td>
</tr>
<tr class="has-fields">
    <td>Dátum narodenia</td>
    <td></td>
    <!-- ko foreach: insuredPersons -->
    <td>
        <div class="dob">
            <input data-bind="value: $data.birthDateDay, attr: {tabindex:$index()*15+3, id:'birthDateDay'+$index()}" type="text" placeholder="DD"/>
            <input data-bind="value: $data.birthDateMonth, attr: {tabindex:$index()*15+4, id:'birthDateMonth'+$index()}" type="text" placeholder="MM"/>
            <input data-bind="value: $data.birthDateYear, attr: {tabindex:$index()*15+5, id:'birthDateYear'+$index()}" type="text" placeholder="YYYY"/>
        </div>
    </td>
    <!-- /ko -->
    <td></td>
</tr>
<tr class="unique has-fields">
    <td>Riziková skupina</td>
    <td><input checked type="checkbox"></td>
    <!-- ko foreach: insuredPersons -->
    <td><select data-bind="options: $root.risks, optionsText: 'value', optionsValue: 'key', value: $data.riskGroup, attr: {tabindex:$index()*15+6, id:'riskGroup'+$index()}"></select></td>
    <!-- /ko -->
    <td></td>
</tr>
<tr class="unique">
    <td>Zľavová karta</td>
    <td><input checked type="checkbox"></td>
    <!-- ko foreach: insuredPersons -->
    <td><input data-bind="checked: $data.discountCard, attr: {tabindex:$index()*15+7, id:'discountCard'+$index()}" type="checkbox"></td>
    <!-- /ko -->
    <td></td>
</tr>
<tr class="section">
    <td>Poistenia</td>
    <td></td>
    <!-- ko foreach: insuredPersons -->
    <td></td>
    <!-- /ko -->
    <td></td>
</tr>
<tr class="unique">
    <td>Liečebné náklady v zahraničí:</td>
    <td><input checked type="checkbox"></td>
    <!-- ko foreach: insuredPersons -->
    <td><input data-bind="checked: $data.medical, attr: {tabindex:$index()*15+8, id:'medical'+$index()}" type="checkbox"></td>
    <!-- /ko -->
    <td></td>
</tr>
<tr class="unique has-fields">
    <td>Batožina:</td>
    <td><input type="checkbox"></td>
    <!-- ko foreach: insuredPersons -->
    <td><select data-bind="options: $root.baggages, optionsText: 'value', optionsValue: 'key', value: $data.baggage, attr: {tabindex:$index()*15+9, id:'baggage'+$index()}"></select></td>
    <!-- /ko -->
    <td></td>
</tr>
<tr class="unique">
    <td>Všeobecná zodpovednosť za škodu:</td>
    <td><input type="checkbox"></td>
    <!-- ko foreach: insuredPersons -->
    <td><input data-bind="checked: $data.responsibility, attr: {tabindex:$index()*15+10, id:'responsibility'+$index()}" type="checkbox"></td>
    <!-- /ko -->
    <td></td>
</tr>
<tr class="unique">
    <td>Úraz:</td>
    <td><input checked type="checkbox"></td>
    <!-- ko foreach: insuredPersons -->
    <td><input data-bind="checked: $data.accident, attr: {tabindex:$index()*15+11, id:'accident'+$index(), id:'accident'+$index()}" type="checkbox"></td>
    <!-- /ko -->
    <td></td>
</tr>
<tr class="unique">
    <td>Náklady na technickú pomoc v prípade záchrannej akcie v horách v zahraničí:</td>
    <td><input checked type="checkbox"></td>
    <!-- ko foreach: insuredPersons -->
    <td><input data-bind="checked: $data.technicalHelp, attr: {tabindex:$index()*15+12, id:'technicalHelp'+$index(), id:'technicalHelp'+$index()}" type="checkbox"></td>
    <!-- /ko -->
    <td></td>
</tr>
<tr class="section">
    <td>Pripoistenia</td>
    <td></td>
    <!-- ko foreach: insuredPersons -->
    <td></td>
    <!-- /ko -->
    <td></td>
</tr>
<tr class="unique has-fields">
    <td>Storno objednanej služby:</td>
    <td><input checked type="checkbox"></td>
    <!-- ko foreach: insuredPersons -->
    <td><div class="price"><input data-bind="value: $data.storno, attr: {tabindex:$index()*15+13, id:'storno'+$index()}" type="text" value="0"></div></td>
    <!-- /ko -->
    <td></td>
</tr>
<tr class="unique">
    <td>Domáci miláčik:</td>
    <td><input checked type="checkbox"></td>
    <!-- ko foreach: insuredPersons -->
    <td><input data-bind="checked: $data.pet, attr: {tabindex:$index()*15+14, id:'pet'+$index()}" type="checkbox"></td>
    <!-- /ko -->
    <td></td>
</tr>
<tr class="unique">
    <td>Dovolenková domácnosť:</td>
    <td><input checked type="checkbox"></td>
    <!-- ko foreach: insuredPersons -->
    <td><input data-bind="checked: $data.vacation, attr: {tabindex:$index()*15+15, id:'vacation'+$index()}" type="checkbox"></td>
    <!-- /ko -->
    <td></td>
</tr>
</tbody>
</table>
<div class="cta">
    <a href="step-2.html" class="button primary next">Ďalej</a>
</div>
<br/><br/>
</div>
<script src="js/jquery-1.10.2.js"></script>
<script src="js/jquery-ui-1.10.4.min.js"></script>
<script src="js/knockout-3.2.0.js"></script>

<script src="js/models/PersonModel.js"></script>
<script src="ikcpModel.js"></script>
<script src="js/utils.js"></script>
<script src="js/ui.js"></script>
<script src="js/ui.jq.js"></script>

<script>

    var ikcp;

    $(document).ready(function()	{

        var model = {};
        ikcp = new IkcpModel( model );

        ko.applyBindings( ikcp );


        //fixed table
        var tbody_width = $("table tbody").css('width');
        $("thead").css('width', tbody_width);
        $("tfoot").css('width', tbody_width);
        $("thead th").each(function()	{
            var idx = $(this).index()+1;
            var new_width = $("tbody tr:nth-child(2) td:nth-child("+idx+")").css('width');
            $(this).css('width', new_width);
            $("tfoot td:nth-child("+idx+")").css('width', new_width);
            console.log(idx, new_width);
        });

        var move = function()	{
            var st = $(window).scrollTop();
            var ot = $("table.edit-grid tbody").offset().top - $("table.edit-grid thead").height();
            var sb = st + $(window).height();
            var ob = ot + $("table.edit-grid tbody").height() + $("table.edit-grid thead").height() + $("table.edit-grid tfoot").height();
            console.log(ob);
            if( st > ot && sb < ob )	{
                $("table.edit-grid").addClass("fixed");
            } else if( st > ot && sb > ob )	{
                $("table.edit-grid").removeClass("fixed");
            } else	{
                $("table.edit-grid").removeClass("fixed");
            }
        }
        move();
        $(window).scroll(move);

        //focus handling
        $(".required input").focus(function()	{
            $(this).parents(".required").addClass("has-focus");
        }).blur(function()	{
            $(this).parents(".required").removeClass("has-focus");
        });
        $(".dob input").focus(function()	{
            $(this).parents(".dob").addClass("has-focus");
        }).blur(function()	{
            $(this).parents(".dob").removeClass("has-focus");
        });
        $(".price input").focus(function()	{
            $(this).parents(".price").addClass("has-focus");
        }).blur(function()	{
            $(this).parents(".price").removeClass("has-focus");
        });

        //help
        $("[href=#show-help]").click(function()	{
            $(this).toggleClass("opened");
            $(".table-help").toggle();
        });
    });
</script>
</body>
</html>